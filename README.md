# openmusicapi-infra

```
                             +----------------+
                             |     Users      |
                             +----------------+
                                      |
                                      v
                        +-----------------------------+
                        |     AWS Load Balancer       |
                        +-----------------------------+
                                      |
                                      v
        +------------------------------------------------------------+
        |                             EKS                            |
        | +----------------+   +----------+   +--------------------+ |
        | | main (Node.js) |-->| RabbitMQ |-->| Consumer (Node.js) | |
        | +----------------+   +----------+   +--------------------+ |
        +------------------------------------------------------------+
                   |                                 |                  
              Caches data                    Stores files to S3        
                   |                                 |                  
                   v                                 v                  
        +--------------------+               +---------------+          
        | ElastiCache (Redis)|               |   Amazon S3   |          
        +--------------------+               +---------------+          
                   |                                 |                  
                   v                                 |                  
        +--------------------------+                 |
        |  Amazon RDS (PostgreSQL) | <------ Save URL to DB     
        +--------------------------+


  +---------------------+  +-----------------+  +-------------------+
  | AWS Secrets Manager |  | IAM Role (IRSA) |  | Amazon ECR (Repo) |
  +---------------------+  +-----------------+  +-------------------+
               Pods assume role to pull secrets & images
```
