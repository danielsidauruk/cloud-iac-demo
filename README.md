# openmusicapi-infra

## Infrastructure Architecture ##

```
                             +----------------+
                             |     Users      |
                             +----------------+
                                      |
                                      v
                        +---------------------------+
                        |     AWS Load Balancer     |
                        +---------------------------+
                                      |                                    
                                      v                                    
        +------------------------------------------------------------+       Pods assume role
        |                             EKS                            |       to pull secrets & images
        | +----------------+   +----------+   +--------------------+ |       +---------------------+
        | | main (Node.js) |-->| RabbitMQ |-->| Consumer (Node.js) | | ----> |   IAM Role (IRSA)   |
        | +----------------+   +----------+   +--------------------+ |       +---------------------+
        +------------------------------------------------------------+                  |
                   |                                 |                                  v
              Caches data                    Stores files to S3              +---------------------+
                   |                                 |                       | AWS Secrets Manager |
                   v                                 v                       +---------------------+
        +---------------------+               +---------------+              +---------------------+
        | ElastiCache (Redis) |               |   Amazon S3   |              |  Amazon ECR (Repo)  |
        +---------------------+               +---------------+              +---------------------+
                   |                                 |                  
                   v                                 |                  
        +-------------------------+                  |
        | Amazon RDS (PostgreSQL) | <------- Save URL to DB     
        +-------------------------+
```
